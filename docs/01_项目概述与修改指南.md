# 钓鱼邮件识别教学游戏 - 项目文档与修改指南

## 1. 项目简介

本项目是一款模仿邮箱的网页小游戏，旨在通过互动游戏的方式，帮助玩家学会如何识别钓鱼邮件，提升网络安全意识。项目采用前后端分离架构，前端基于 Vue 3，后端基于 Python FastAPI。

本文档将为您提供项目的整体介绍、技术细节以及如何进行常见内容的修改。

## 2. 技术栈

理解技术栈有助于您了解维护本项目所需的技术背景。

- **前端**:
  - **框架**: Vue 3 (使用 `@vue/cli` 脚手架构建)
  - **UI 库**: Element Plus (提供了大部分界面组件，如按钮、表格、弹窗等)
  - **状态管理**: Pinia (用于管理全局数据，如用户信息、游戏状态等)
  - **路由**: Vue Router (用于管理页面跳转)
  - **HTTP 请求**: Axios (用于与后端 API 通信)

- **后端**:
  - **框架**: FastAPI (一个高性能的 Python Web 框架)
  - **数据库 ORM**: SQLAlchemy (帮助我们用 Python 代码操作数据库，无需手写 SQL)
  - **数据库**:
    - **开发环境**: SQLite (一个轻量级的文件数据库，方便本地运行)
    - **生产环境**: 推荐使用 PostgreSQL (性能更强、更稳定)
  - **异步服务**: Uvicorn (用于运行 FastAPI 应用)
  - **生产部署**: Gunicorn (一个更健壮的 Python 应用服务器)

## 3. 项目结构说明

了解文件结构是修改项目的第一步。

```
game/
├── backend/            # 后端所有代码
│   ├── app/
│   │   ├── crud/       # 核心：数据库增、删、改、查 (CRUD) 的具体实现
│   │   ├── data/       # 核心：存放用于初始化数据库的样本数据
│   │   ├── models/     # 核心：定义数据库表结构的 Python 类
│   │   ├── routers/    # 核心：API 接口的定义文件 (如 auth.py, game.py)
│   │   ├── schemas.py  # 定义 API 请求和响应的数据格式
│   │   ├── main.py     # FastAPI 应用的主入口文件
│   │   └── ...
│   └── requirements.txt  # 后端的 Python 依赖包列表
│
├── frontend/           # 前端所有代码
│   ├── src/
│   │   ├── assets/     # 存放静态资源 (如图片、全局样式)
│   │   ├── components/ # 核心：可复用的 Vue 组件 (如邮件列表项、弹窗)
│   │   ├── stores/     # 核心：Pinia 状态管理文件 (如 auth.js, game.js)
│   │   ├── views/      # 核心：页面级 Vue 组件 (如登录页、游戏主页)
│   │   ├── router/     # 核心：前端路由配置文件
│   │   └── main.js     # 前端应用的主入口文件
│   └── package.json    # 前端的 Node.js 依赖包列表
│
└── docs/               # 存放所有交付与说明文档 (您正在阅读的系列文档)
```

## 4. 如何修改游戏内容

我们提供了两种修改游戏内容（关卡和邮件）的方式，推荐使用第一种。

### 方式一：通过管理员后台修改 (推荐)

这是一种安全、直观、无需修改代码的方式。

1.  **确保您有一个管理员账号**。
    - 在本地运行项目后，会生成一个 `sql_app.db` 文件。您可以使用任何 SQLite 可视化工具 (如 DB Browser for SQLite) 打开它。
    - 找到 `users` 表，将您自己注册的用户的 `is_admin` 字段的值从 `0` (或 `false`) 修改为 `1` (或 `true`)。

2.  **登录并访问后台**。
    - 使用修改后的管理员账号登录游戏。
    - 手动在浏览器地址栏输入 `http://localhost:8080/admin` (本地环境) 或 `http://您的域名/admin` (服务器环境)。

3.  **在后台管理**。
    - 您会看到关卡管理、邮件管理和数据统计的界面。
    - 在这里，您可以自由地**增加、删除、修改关卡和邮件**，所有修改都会实时生效。

### 方式二：通过修改代码初始化数据 (适合批量操作)

如果您需要进行大规模的、初始化的内容添加，可以直接修改代码。

1.  **找到数据源文件**：
    所有初始化的关卡和邮件数据都定义在 `backend/app/data/sample_data.py` 文件中。

2.  **修改数据**：
    您可以直接在这个文件的 `LEVELS_DATA` (关卡) 和 `EMAILS_DATA` (邮件) 变量中添加或修改内容。请遵循现有的 Python 字典格式。

3.  **重新初始化数据库**：
    **重要提示：此操作会清空现有数据库！**
    - 首先，删除项目根目录下的 `sql_app.db` 文件。
    - 然后，在 `backend` 目录下，运行以下命令来重新创建数据库和数据：
      ```bash
      # 确保您在 backend 目录并已激活虚拟环境
      python -m app.data.init
      ```

## 5. 如何修改页面文字或样式

所有界面的修改都在 `frontend` 文件夹中。

-   **修改特定页面的文字/布局**：
    -   到 `frontend/src/views/` 文件夹中寻找对应的 `.vue` 文件。例如，要修改开始页面，就编辑 `Start.vue`。

-   **修改可复用组件**：
    -   如果您想修改邮件列表的样式，可以到 `frontend/src/components/` 中找到 `EmailItem.vue` 进行修改。

-   **修改全局样式或图片**：
    -   图片等静态资源放在 `frontend/src/assets/` 目录下。

-   **修改 API 请求地址**：
    -   如果后端 API 地址发生变化，可以在 `frontend/src/utils/config.js` 文件中修改 `API_BASE_URL`。 